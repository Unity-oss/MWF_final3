<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Attendance</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet"/>
    <script src="https://cdn.tailwindcss.com"></script>
  </head>
  <body>
    <header>
      <nav style="background-color: #b53be6; padding: 10px">
        <a href="/" style="color: white; margin-right: 15px; text-decoration: none">Home</a>
        <a href="/add" style="color: white; margin-right: 15px; text-decoration: none">Add attendance</a>
      </nav>
    </header>

    <!-- Centered Table -->
    <div class="flex justify-center mt-8 px-4">
      <div class="overflow-x-auto w-full max-w-5xl">
        <table class="table-auto border text-center w-full shadow-md rounded-lg overflow-hidden">
          <thead>
            <tr class="bg-gray-100">
              <th class="py-3 px-4 text-gray-600 font-bold uppercase">Product ID</th>
              <th class="py-3 px-4 text-gray-600 font-bold uppercase">Customer</th>
              <th class="py-3 px-4 text-gray-600 font-bold uppercase">Product</th>
              <th class="py-3 px-4 text-gray-600 font-bold uppercase">Type</th>
              <th class="py-3 px-4 text-gray-600 font-bold uppercase">Date</th>
              <th class="py-3 px-4 text-gray-600 font-bold uppercase">Payment</th>
              <th class="py-3 px-4 text-gray-600 font-bold uppercase">Agent</th>
              <th class="py-3 px-4 text-gray-600 font-bold uppercase">Transport</th>
              <th class="py-3 px-4 text-gray-600 font-bold uppercase">Actions</th>
            </tr>
          </thead>
          <tbody class="bg-white">
            {% for item in Attendances %}
            <tr>
              <td class="py-3 px-4 border-b border-gray-200">{{ item.student_id }}</td>
              <td class="py-3 px-4 border-b border-gray-200">{{ item.date }}</td>
              <td class="py-3 px-4 border-b border-gray-200">{{ item.name }}</td>
              <td class="py-3 px-4 border-b border-gray-200">{{ item.statusPresence }}</td>
              <td class="py-3 px-4 border-b border-gray-200">
                <a href="/view/{{ item.id }}" class="px-3 py-1 bg-blue-600 text-white rounded-md">View</a>
                <a href="/edit/{{ item.id }}" class="ml-2 px-3 py-1 bg-green-600 text-white rounded-md">Edit</a>

                <!-- ✅ Delete button triggers unique modal -->
                <button class="ml-2 px-3 py-1 bg-red-600 text-white rounded-md"
                        data-bs-toggle="modal" data-bs-target="#deleteModal{{ item.id }}">
                  Delete
                </button>
              </td>
            </tr>

            <!-- ✅ Unique Modal per record -->
            <div class="modal fade" id="deleteModal{{ item.id }}" tabindex="-1" aria-labelledby="deleteModalLabel{{ item.id }}" aria-hidden="true">
              <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content">
                  <div class="modal-header">
                    <h5 class="modal-title" id="deleteModalLabel{{ item.id }}">Confirm Delete</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                  </div>
                  <div class="modal-body">
                    Are you sure you want to delete <strong>{{ item.name }}</strong> (ID: {{ item.student_id }})?
                  </div>
                  <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <form method="POST" action="/delete/{{ item.id }}/"
                      {% csrf_token %}
                      <button type="submit" class="btn btn-danger">Confirm Delete</button>
                    </form>
                  </div>
                </div>
              </div>
            </div>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"></script>
  </body>
</html>