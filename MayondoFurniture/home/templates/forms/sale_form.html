{% load crispy_forms_tags %}

{# Card Header with Stock Info #}
<div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6 mb-6">
    <div class="flex items-center justify-between">
        <div>
            <h2 class="text-xl font-semibold text-gray-900">Sale Information</h2>
            <p class="text-sm text-gray-600 mt-1">Product ID will be automatically generated when you save this sale.</p>
        </div>
        <div class="text-right">
            <p class="text-sm font-medium text-green-600">
                <i class="fas fa-box mr-1"></i>
                {{ data.available_products|length }} product{{ data.available_products|length|pluralize }} available for sale
            </p>
            <p class="text-xs text-gray-500">Only in-stock items are shown</p>
        </div>
    </div>
</div>

{# Display non-field errors #}
{% if form.non_field_errors %}
<div class="text-red-600 mb-4">
    {{ form.non_field_errors }}
</div>
{% endif %}

{# Customer Name (full width) #}
<div class="form-row mb-4">
    <div class="col-12">
        {{ form.customer_name|as_crispy_field }}
        {% if form.customer_name.errors %}
            <p class="text-red-600 text-sm">{{ form.customer_name.errors }}</p>
        {% endif %}
    </div>
</div>

{# Product Selection (2 columns) #}
<div class="form-row mb-4">
    <div class="col-md-6">
        {{ form.product_name|as_crispy_field }}
        {% if form.product_name.errors %}
            <p class="text-red-600 text-sm">{{ form.product_name.errors }}</p>
        {% endif %}
    </div>
    <div class="col-md-6">
        {{ form.product_type|as_crispy_field }}
        {% if form.product_type.errors %}
            <p class="text-red-600 text-sm">{{ form.product_type.errors }}</p>
        {% endif %}
    </div>
</div>

{# Quantity, Unit Price, Total Sales Amount (3 columns) #}
<div class="form-row mb-4">
    <div class="col-md-4">
        {{ form.quantity|as_crispy_field }}
        {% if form.quantity.errors %}
            <p class="text-red-600 text-sm">{{ form.quantity.errors }}</p>
        {% endif %}
    </div>
    <div class="col-md-4">
        {{ form.unit_price|as_crispy_field }}
        {% if form.unit_price.errors %}
            <p class="text-red-600 text-sm">{{ form.unit_price.errors }}</p>
        {% endif %}
    </div>
    <div class="col-md-4">
        {{ form.total_sales_amount|as_crispy_field }}
        {% if form.total_sales_amount.errors %}
            <p class="text-red-600 text-sm">{{ form.total_sales_amount.errors }}</p>
        {% endif %}
       
    </div>
</div>

{# Date and Payment Type (2 columns) #}
<div class="form-row mb-4">
    <div class="col-md-6">
        {{ form.date|as_crispy_field }}
        {% if form.date.errors %}
            <p class="text-red-600 text-sm">{{ form.date.errors }}</p>
        {% endif %}
    </div>
    <div class="col-md-6">
        {{ form.payment_type|as_crispy_field }}
        {% if form.payment_type.errors %}
            <p class="text-red-600 text-sm">{{ form.payment_type.errors }}</p>
        {% endif %}
    </div>
</div>

{# Sales Agent and Transport (2 columns) #}
<div class="form-row mb-4">
    <div class="col-md-8">
        {{ form.sales_agent|as_crispy_field }}
        {% if form.sales_agent.errors %}
            <p class="text-red-600 text-sm">{{ form.sales_agent.errors }}</p>
        {% endif %}
    </div>
    <div class="col-md-4 d-flex align-items-center">
        {{ form.transport_required|as_crispy_field }}
        {% if form.transport_required.errors %}
            <p class="text-red-600 text-sm">{{ form.transport_required.errors }}</p>
        {% endif %}
    </div>
</div>

{# Form actions (Save / Cancel buttons) #}
{% include 'snippets/form_actions.html' with submit_text='Save Sale' cancel_url='/saleRecord/' %}
